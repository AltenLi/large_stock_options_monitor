# -*- coding: utf-8 -*-
"""
港股期权大单监控配置文件
"""

# Futu OpenD 配置
FUTU_CONFIG = {
    'host': '127.0.0.1',
    'port': 11111,
    'unlock_pwd': '',  # 请填入你的交易密码
    'market': 'HK',    # 港股市场
}

# 监控的港股股票代码列表 (港股格式: HK.00700)
MONITOR_STOCKS = [
    'HK.00700',  # 腾讯控股
    'HK.09988',  # 阿里巴巴
    'HK.03690',  # 美团
    'HK.01810',  # 小米集团
    'HK.09618',  # 京东集团
    'HK.02318',  # 中国平安
    'HK.00388',  # 香港交易所
    'HK.00981',  # 中芯国际
]

# 期权大单筛选条件（默认阈值 + 按股票覆盖）
DEFAULT_OPTION_FILTER = {
    'min_volume': 10,        # 最小成交量 
    'min_turnover': 10000,   # 最小成交额 (港币) 
    'min_premium': 0.01,     # 最小权利金
    'price_range': 0.15,     # 价格范围
}

# 每只股票的自定义过滤阈值（覆盖默认值，未配置的字段沿用默认）
OPTION_FILTERS = {
    # 示例：腾讯控股
    'HK.00700': {
        'min_volume': 20,
        'min_turnover': 20000,
    },
    # 示例：阿里巴巴
    'HK.09988': {
        'min_volume': 15,
        'min_turnover': 15000,
    },
    # 如需为更多股票设置，按上述格式添加
}

# 兼容旧版代码：仍提供 OPTION_FILTER 作为默认值引用
OPTION_FILTER = DEFAULT_OPTION_FILTER

# 工具函数：获取某只股票的最终过滤配置（默认+覆盖）
def get_option_filter(stock_code: str):
    try:
        override = OPTION_FILTERS.get(stock_code, {})
        cfg = DEFAULT_OPTION_FILTER.copy()
        cfg.update(override)
        return cfg
    except Exception:
        return DEFAULT_OPTION_FILTER

# 监控时间设置
MONITOR_TIME = {
    'start_time': '09:30:00',  # 开始监控时间
    'end_time': '16:00:00',    # 结束监控时间
    'interval': 300,          # 监控间隔(秒) - 5分钟刷新一次
    'lookback_days': 2,        # 回看天数
}

# 通知设置
NOTIFICATION = {
    'enable_console': True,    # 控制台输出
    'enable_log': True,        # 日志记录
    'enable_email': False,     # 邮件通知
    'enable_mac_notification': True,  # Mac系统通知
    'enable_wework_bot': True,  # 企微机器人通知
    'email_config': {
        'smtp_server': 'smtp.gmail.com',
        'smtp_port': 587,
        'username': '',
        'password': '',
        'to_emails': [],
    },
    'wework_config': {
        'webhook_url': '',  # 企微机器人webhook地址
        'mentioned_list': [],  # @的用户列表，如 ['@all'] 或 ['userid1', 'userid2']
        'mentioned_mobile_list': [],  # @的手机号列表
    }
}

# 日志配置
LOG_CONFIG = {
    'log_level': 'INFO',
    'log_file': 'logs/option_monitor.log',
    'max_file_size': 10 * 1024 * 1024,  # 10MB
    'backup_count': 5,
}

# 数据存储配置
DATA_CONFIG = {
    'save_to_csv': True,
    'csv_path': 'data/option_trades.csv',
    'save_to_db': False,  # 可扩展数据库存储
    'big_options_json': 'data/current_big_option.json',  # 大单期权汇总文件
}

# Web面板配置
WEB_CONFIG = {
    'host': '0.0.0.0',     # 监听地址
    'port': 8288,          # 端口号 (避免与AirPlay冲突)
    'debug': False,        # 调试模式
    'auto_reload': True,   # 自动重载
}

# 财报监控配置
EARNINGS_CONFIG = {
    # 监控的天数范围（未来多少天内的财报）
    'days_ahead': 30,
    
    # 财报相关的期权监控增强
    'earnings_option_filter': {
        'min_volume': 50,      # 财报期间最小成交量
        'min_amount': 500000,  # 财报期间最小成交额(港币)
        'days_before_earnings': 7,  # 财报前几天开始重点监控
        'days_after_earnings': 2,   # 财报后几天继续监控
    },
    
    # 财报提醒配置
    'notification': {
        'enabled': True,
        'advance_days': [7, 3, 1],  # 提前几天提醒
        'message_template': "🏢 {stock_name}({stock_code}) 将在 {days} 天后({date})发布财报"
    }
}